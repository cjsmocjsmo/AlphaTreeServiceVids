async function onVisible(astroId, options, getHydrateCallback) {
  const roots = document.querySelectorAll(`astro-root[uid="${astroId}"]`);
  if (roots.length === 0) {
    throw new Error(`Unable to find the root for the component ${options.name}`);
  }
  let innerHTML = null;
  let fragment = roots[0].querySelector(`astro-fragment`);
  if (fragment == null && roots[0].hasAttribute("tmpl")) {
    let template = roots[0].querySelector(`template[data-astro-template]`);
    if (template) {
      innerHTML = template.innerHTML;
      template.remove();
    }
  } else if (fragment) {
    innerHTML = fragment.innerHTML;
  }
  const cb = async () => {
    const hydrate = await getHydrateCallback();
    for (const root of roots) {
      hydrate(root, innerHTML);
    }
  };
  const io = new IntersectionObserver((entries) => {
    for (const entry of entries) {
      if (!entry.isIntersecting)
        continue;
      io.disconnect();
      cb();
      break;
    }
  });
  for (const root of roots) {
    for (let i = 0; i < root.children.length; i++) {
      const child = root.children[i];
      io.observe(child);
    }
  }
}
export {
  onVisible as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL3J1bnRpbWUvY2xpZW50L3Zpc2libGUudHMiXSwKICAibWFwcGluZ3MiOiAiQUFPQSx5QkFBd0MsU0FBaUIsU0FBeUIsb0JBQXdDO0FBQ3pILFFBQU0sUUFBUSxTQUFTLGlCQUFpQixtQkFBbUIsV0FBVztBQUN0RSxNQUFJLE1BQU0sV0FBVyxHQUFHO0FBQ3ZCLFVBQU0sSUFBSSxNQUFNLDZDQUE2QyxRQUFRLE1BQU07QUFBQSxFQUM1RTtBQUVBLE1BQUksWUFBMkI7QUFDL0IsTUFBSSxXQUFXLE1BQU0sR0FBRyxjQUFjLGdCQUFnQjtBQUN0RCxNQUFJLFlBQVksUUFBUSxNQUFNLEdBQUcsYUFBYSxNQUFNLEdBQUc7QUFHdEQsUUFBSSxXQUFXLE1BQU0sR0FBRyxjQUFjLCtCQUErQjtBQUNyRSxRQUFJLFVBQVU7QUFDYixrQkFBWSxTQUFTO0FBQ3JCLGVBQVMsT0FBTztBQUFBLElBQ2pCO0FBQUEsRUFDRCxXQUFXLFVBQVU7QUFDcEIsZ0JBQVksU0FBUztBQUFBLEVBQ3RCO0FBRUEsUUFBTSxLQUFLLFlBQVk7QUFDdEIsVUFBTSxVQUFVLE1BQU0sbUJBQW1CO0FBQ3pDLGVBQVcsUUFBUSxPQUFPO0FBQ3pCLGNBQVEsTUFBTSxTQUFTO0FBQUEsSUFDeEI7QUFBQSxFQUNEO0FBRUEsUUFBTSxLQUFLLElBQUkscUJBQXFCLENBQUMsWUFBWTtBQUNoRCxlQUFXLFNBQVMsU0FBUztBQUM1QixVQUFJLENBQUMsTUFBTTtBQUFnQjtBQUUzQixTQUFHLFdBQVc7QUFDZCxTQUFHO0FBQ0g7QUFBQSxJQUNEO0FBQUEsRUFDRCxDQUFDO0FBRUQsYUFBVyxRQUFRLE9BQU87QUFDekIsYUFBUyxJQUFJLEdBQUcsSUFBSSxLQUFLLFNBQVMsUUFBUSxLQUFLO0FBQzlDLFlBQU0sUUFBUSxLQUFLLFNBQVM7QUFDNUIsU0FBRyxRQUFRLEtBQUs7QUFBQSxJQUNqQjtBQUFBLEVBQ0Q7QUFDRDsiLAogICJuYW1lcyI6IFtdCn0K
