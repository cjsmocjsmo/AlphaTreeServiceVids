import { resolveDependency } from "../../util.js";
import { createRenderer } from "../renderer.js";
const cache = /* @__PURE__ */ new Map();
async function resolveRenderer(viteServer, renderer, astroConfig) {
  const resolvedRenderer = await createRenderer(renderer, {
    renderer(name) {
      return import(resolveDependency(name, astroConfig));
    },
    async server(entry) {
      const { url } = await viteServer.moduleGraph.ensureEntryFromUrl(entry);
      const mod = await viteServer.ssrLoadModule(url);
      return mod;
    }
  });
  return resolvedRenderer;
}
async function resolveRenderers(viteServer, astroConfig) {
  const ids = astroConfig.renderers;
  const renderers = await Promise.all(ids.map((renderer) => {
    if (cache.has(renderer))
      return cache.get(renderer);
    let promise = resolveRenderer(viteServer, renderer, astroConfig);
    cache.set(renderer, promise);
    return promise;
  }));
  return renderers;
}
export {
  resolveRenderers
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vc3JjL2NvcmUvcmVuZGVyL2Rldi9yZW5kZXJlcnMudHMiXSwKICAibWFwcGluZ3MiOiAiQUFHQTtBQUNBO0FBRUEsTUFBTSxRQUFRLG9CQUFJLElBQStCO0FBRWpELCtCQUErQixZQUFnQyxVQUFrQixhQUE2QztBQUM3SCxRQUFNLG1CQUE2QixNQUFNLGVBQWUsVUFBVTtBQUFBLElBQ2pFLFNBQVMsTUFBTTtBQUNkLGFBQU8sT0FBTyxrQkFBa0IsTUFBTSxXQUFXO0FBQUEsSUFDbEQ7QUFBQSxVQUNNLE9BQU8sT0FBTztBQUNuQixZQUFNLEVBQUUsUUFBUSxNQUFNLFdBQVcsWUFBWSxtQkFBbUIsS0FBSztBQUNyRSxZQUFNLE1BQU0sTUFBTSxXQUFXLGNBQWMsR0FBRztBQUM5QyxhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0QsQ0FBQztBQUVELFNBQU87QUFDUjtBQUVBLGdDQUF1QyxZQUFnQyxhQUErQztBQUNySCxRQUFNLE1BQWdCLFlBQVk7QUFDbEMsUUFBTSxZQUFZLE1BQU0sUUFBUSxJQUMvQixJQUFJLElBQUksQ0FBQyxhQUFhO0FBQ3JCLFFBQUksTUFBTSxJQUFJLFFBQVE7QUFBRyxhQUFPLE1BQU0sSUFBSSxRQUFRO0FBQ2xELFFBQUksVUFBVSxnQkFBZ0IsWUFBWSxVQUFVLFdBQVc7QUFDL0QsVUFBTSxJQUFJLFVBQVUsT0FBTztBQUMzQixXQUFPO0FBQUEsRUFDUixDQUFDLENBQ0Y7QUFFQSxTQUFPO0FBQ1I7IiwKICAibmFtZXMiOiBbXQp9Cg==
