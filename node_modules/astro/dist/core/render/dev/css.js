import path from "path";
import { viteID } from "../../util.js";
const STYLE_EXTENSIONS = /* @__PURE__ */ new Set([".css", ".pcss", ".postcss", ".scss", ".sass", ".styl", ".stylus", ".less"]);
const cssRe = new RegExp(`\\.(${Array.from(STYLE_EXTENSIONS).map((s) => s.slice(1)).join("|")})($|\\?)`);
const isCSSRequest = (request) => cssRe.test(request);
function getStylesForURL(filePath, viteServer) {
  const css = /* @__PURE__ */ new Set();
  function crawlCSS(id, scanned = /* @__PURE__ */ new Set()) {
    const moduleName = viteServer.moduleGraph.idToModuleMap.get(id);
    if (!moduleName || !moduleName.id)
      return;
    scanned.add(moduleName.id);
    for (const importedModule of moduleName.importedModules) {
      if (!importedModule.id || scanned.has(importedModule.id))
        continue;
      const ext = path.extname(importedModule.url.toLowerCase());
      if (STYLE_EXTENSIONS.has(ext)) {
        css.add(importedModule.url);
      }
      crawlCSS(importedModule.id, scanned);
    }
  }
  crawlCSS(viteID(filePath));
  return css;
}
export {
  STYLE_EXTENSIONS,
  getStylesForURL,
  isCSSRequest
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vc3JjL2NvcmUvcmVuZGVyL2Rldi9jc3MudHMiXSwKICAibWFwcGluZ3MiOiAiQUFFQTtBQUNBO0FBR08sTUFBTSxtQkFBbUIsb0JBQUksSUFBSSxDQUFDLFFBQVEsU0FBUyxZQUFZLFNBQVMsU0FBUyxTQUFTLFdBQVcsT0FBTyxDQUFDO0FBRXBILE1BQU0sUUFBUSxJQUFJLE9BQ2pCLE9BQU8sTUFBTSxLQUFLLGdCQUFnQixFQUNoQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLEVBQ3JCLEtBQUssR0FBRyxXQUNYO0FBQ08sTUFBTSxlQUFlLENBQUMsWUFBNkIsTUFBTSxLQUFLLE9BQU87QUFNckUseUJBQXlCLFVBQWUsWUFBNkM7QUFDM0YsUUFBTSxNQUFNLG9CQUFJLElBQVk7QUFHNUIsb0JBQWtCLElBQVksVUFBVSxvQkFBSSxJQUFZLEdBQUc7QUFHMUQsVUFBTSxhQUFhLFdBQVcsWUFBWSxjQUFjLElBQUksRUFBRTtBQUM5RCxRQUFJLENBQUMsY0FBYyxDQUFDLFdBQVc7QUFBSTtBQUVuQyxZQUFRLElBQUksV0FBVyxFQUFFO0FBR3pCLGVBQVcsa0JBQWtCLFdBQVcsaUJBQWlCO0FBQ3hELFVBQUksQ0FBQyxlQUFlLE1BQU0sUUFBUSxJQUFJLGVBQWUsRUFBRTtBQUFHO0FBQzFELFlBQU0sTUFBTSxLQUFLLFFBQVEsZUFBZSxJQUFJLFlBQVksQ0FBQztBQUN6RCxVQUFJLGlCQUFpQixJQUFJLEdBQUcsR0FBRztBQUM5QixZQUFJLElBQUksZUFBZSxHQUFHO0FBQUEsTUFDM0I7QUFDQSxlQUFTLGVBQWUsSUFBSSxPQUFPO0FBQUEsSUFDcEM7QUFBQSxFQUNEO0FBRUEsV0FBUyxPQUFPLFFBQVEsQ0FBQztBQUV6QixTQUFPO0FBQ1I7IiwKICAibmFtZXMiOiBbXQp9Cg==
